import{a as h,j as e}from"./index-CPzySNJ6.js";import{b as u,a as C}from"./index.esm-0ZY5LNBC.js";import{C as b,a as g}from"./CCardBody-BGkKNak_.js";import{C as y}from"./CCardHeader-Da_ygHkv.js";import{C as v}from"./CForm-CqQ0rbrG.js";import{C as f}from"./CFormLabel-CHhEuAnE.js";import{C as m}from"./CFormInput-Baipu2v1.js";import{C as E}from"./CFormTextarea-C1wPq4ve.js";import"./CFormControlWrapper-3MNphKfH.js";import"./CFormControlValidation-Dtm9-cnB.js";const G=()=>{const[i,x]=h.useState(null),[a,l]=h.useState({});h.useEffect(()=>{(async()=>{try{const t=await fetch("https://api-hackaton-talentotechriente.onrender.com/api/panel-info");if(!t.ok)throw new Error("Error al cargar datos");const n=await t.json();x(n);const o={};n.campos.forEach(s=>{s.tipo==="lista"&&Array.isArray(s.campos)?(o[s.nombre]={},s.campos.forEach(d=>{o[s.nombre][d.nombre]=d.valor??""})):o[s.nombre]=s.valor??""}),l(o)}catch(t){console.error("Fetch error:",t),x({campos:[]}),l({})}})()},[]);const c=(r,t,n=null)=>{l(n?o=>({...o,[r]:{...o[r],[n]:t}}):o=>({...o,[r]:t}))},j=async()=>{try{if(!(await fetch("https://api-hackaton-talentotechriente.onrender.com/api/panel-info",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw new Error("Error al guardar");alert("Datos guardados con Ã©xito")}catch(r){alert("Error guardando: "+r.message)}},p=()=>{if(!i)return;const r={};i.campos.forEach(t=>{t.tipo==="lista"&&Array.isArray(t.campos)?(r[t.nombre]={},t.campos.forEach(n=>{r[t.nombre][n.nombre]=n.valor??""})):r[t.nombre]=t.valor??""}),l(r)};return i?e.jsx(u,{className:"py-4",children:e.jsxs(b,{children:[e.jsx(y,{children:e.jsx("h3",{children:i.titulo})}),e.jsx(g,{children:e.jsxs(v,{children:[i.campos.map((r,t)=>r.tipo==="lista"?e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:r.nombre}),r.descripcion&&e.jsx("p",{children:r.descripcion}),r.campos.map((n,o)=>{var s;return e.jsxs("div",{className:"mb-2",children:[e.jsx(f,{children:n.nombre}),e.jsx(m,{type:n.tipo==="fecha"?"date":"text",value:((s=a==null?void 0:a[r.nombre])==null?void 0:s[n.nombre])||"",onChange:d=>c(r.nombre,d.target.value,n.nombre)})]},o)})]},t):e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{children:r.nombre}),r.tipo==="texto_largo"?e.jsx(E,{value:(a==null?void 0:a[r.nombre])||"",onChange:n=>c(r.nombre,n.target.value)}):r.tipo==="fecha"?e.jsx(m,{type:"date",value:(a==null?void 0:a[r.nombre])||"",onChange:n=>c(r.nombre,n.target.value)}):e.jsx(m,{type:"text",value:(a==null?void 0:a[r.nombre])||"",onChange:n=>c(r.nombre,n.target.value)})]},t)),e.jsxs("div",{className:"d-flex gap-2 mt-4",children:[e.jsx(C,{color:"primary",onClick:j,children:"Guardar"}),e.jsx(C,{color:"secondary",onClick:p,children:"Cancelar"})]})]})})]})}):e.jsx("p",{children:"Cargando datos..."})};export{G as default};
