import{a as h,j as e}from"./index-D1GfoRut.js";import{b as p,a as f}from"./index.esm-D_EbHEUo.js";import{C as b,a as g}from"./CCardBody-BphMurVQ.js";import{C as y}from"./CCardHeader-AOH0Yd8w.js";import{C as v}from"./CForm-BqseJbij.js";import{C as m}from"./CFormLabel-mXd6wkCI.js";import{C as x}from"./CFormInput-B5XrL5wc.js";import{C as E}from"./CFormTextarea-CJWTq1Gd.js";import"./CFormControlWrapper-Afeoppo6.js";import"./CFormControlValidation-B6uVlOyr.js";const G=()=>{const[i,C]=h.useState(null),[n,l]=h.useState({});h.useEffect(()=>{(async()=>{try{const t=await fetch("http://localhost:3001/api/panel-info");if(!t.ok)throw new Error("Error al cargar datos");const a=await t.json();C(a);const s={};a.campos.forEach(o=>{o.tipo==="lista"&&Array.isArray(o.campos)?(s[o.nombre]={},o.campos.forEach(d=>{s[o.nombre][d.nombre]=d.valor??""})):s[o.nombre]=o.valor??""}),l(s)}catch(t){console.error("Fetch error:",t),C({campos:[]}),l({})}})()},[]);const c=(r,t,a=null)=>{l(a?s=>({...s,[r]:{...s[r],[a]:t}}):s=>({...s,[r]:t}))},j=async()=>{try{if(!(await fetch("http://localhost:3001/api/panel-info",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)throw new Error("Error al guardar");alert("Datos guardados con Ã©xito")}catch(r){alert("Error guardando: "+r.message)}},u=()=>{if(!i)return;const r={};i.campos.forEach(t=>{t.tipo==="lista"&&Array.isArray(t.campos)?(r[t.nombre]={},t.campos.forEach(a=>{r[t.nombre][a.nombre]=a.valor??""})):r[t.nombre]=t.valor??""}),l(r)};return i?e.jsx(p,{className:"py-4",children:e.jsxs(b,{children:[e.jsx(y,{children:e.jsx("h3",{children:i.titulo})}),e.jsx(g,{children:e.jsxs(v,{children:[i.campos.map((r,t)=>r.tipo==="lista"?e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:r.nombre}),r.descripcion&&e.jsx("p",{children:r.descripcion}),r.campos.map((a,s)=>{var o;return e.jsxs("div",{className:"mb-2",children:[e.jsx(m,{children:a.nombre}),e.jsx(x,{type:a.tipo==="fecha"?"date":"text",value:((o=n==null?void 0:n[r.nombre])==null?void 0:o[a.nombre])||"",onChange:d=>c(r.nombre,d.target.value,a.nombre)})]},s)})]},t):e.jsxs("div",{className:"mb-3",children:[e.jsx(m,{children:r.nombre}),r.tipo==="texto_largo"?e.jsx(E,{value:(n==null?void 0:n[r.nombre])||"",onChange:a=>c(r.nombre,a.target.value)}):r.tipo==="fecha"?e.jsx(x,{type:"date",value:(n==null?void 0:n[r.nombre])||"",onChange:a=>c(r.nombre,a.target.value)}):e.jsx(x,{type:"text",value:(n==null?void 0:n[r.nombre])||"",onChange:a=>c(r.nombre,a.target.value)})]},t)),e.jsxs("div",{className:"d-flex gap-2 mt-4",children:[e.jsx(f,{color:"primary",onClick:j,children:"Guardar"}),e.jsx(f,{color:"secondary",onClick:u,children:"Cancelar"})]})]})})]})}):e.jsx("p",{children:"Cargando datos..."})};export{G as default};
